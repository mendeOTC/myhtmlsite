<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Funding Application - Redesigned</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind to include custom colors and fonts -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                        montserrat: ['Montserrat', 'sans-serif'],
                        'open-sans': ['Open Sans', 'sans-serif'],
                    },
                    colors: {
                        primaryBlue: '#007bff',
                        darkBlue: '#0056b3',
                        lightBlueBg: '#e0f7fa',
                        accentGreen: '#28a745',
                        grayText: '#495057',
                        lightGrayBorder: '#dee2e6',
                        backgroundWhite: '#ffffff',
                        backgroundBody: '#f8f9fa',
                        modernPrimary: '#1a202c',
                        modernSecondary: '#4a5568',
                        modernAccent: '#3182ce',
                        modernBgLight: '#f7fafc',
                        modernBorder: '#e2e8f0',
                    }
                }
            }
        }
    </script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Custom Styles (minimal, mostly for specific overrides or non-Tailwind elements) -->
    <style>
        /* Ensure box-sizing is border-box globally for consistent layout */
        *, *::before, *::after {
            box-sizing: border-box;
        }
        body {
            font-family: 'Open Sans', sans-serif;
            /* Background gradient applied to body for full page effect */
            background: linear-gradient(135deg, theme('colors.modernBgLight') 0%, theme('colors.backgroundWhite') 100%);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Style for date input to ensure light mode calendar */
        input[type="date"] {
            color-scheme: light;
        }
        /* Custom styles for signature canvas border on error */
        .signature-canvas-container.error {
            border: 1px solid red !important;
        }

        /* Custom Message Box Styles */
        #customMessageBox {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-size: 1em;
            font-weight: 600;
            z-index: 2000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }

        /* Specific styling for the active step icon */
        .step-btn .active-icon { /* Apply default circle icon */
            content: "\f111"; /* Circle icon */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            color: theme('colors.modernBorder');
            font-size: 0.8em;
            transition: color 0.3s ease, content 0.3s ease; /* Transition content for icon change */
        }

        .step-btn.active-step .active-icon {
            color: theme('colors.modernAccent'); /* Active step color */
            content: "\f058"; /* Checkmark circle for active */
        }
        /* Hover effect for step buttons */
        .step-btn:not(.active-step):hover {
            transform: translateX(5px);
        }
    </style>
</head>
<body class="flex flex-col min-h-screen text-modernSecondary">

    <!-- Header Section -->
    <header class="bg-backgroundWhite p-4 md:px-10 flex flex-col md:flex-row justify-between items-center shadow-sm sticky top-0 z-50 border-b border-modernBorder">
        <a href="https://ontimecap.com/" class="logo-link mb-4 md:mb-0" target="_blank">
            <img src="https://ontimecap.com/wp-content/uploads/2024/05/logos3-1.png" alt="On Time Capital Logo" class="h-14 transition-transform duration-200 hover:scale-105">
        </a>
        <div class="flex items-center font-montserrat font-semibold text-modernPrimary gap-2">
            <span class="text-lg">Need help?</span>
            <i class="fas fa-phone-alt text-xl text-modernPrimary"></i>
            <a href="tel:4122046096" class="text-xl text-modernPrimary no-underline hover:text-modernAccent transition-colors duration-200">412 204 6096</a>
        </div>
    </header>

    <!-- Main Content Wrapper -->
    <div class="flex flex-col md:flex-row flex-grow w-full">

        <!-- Sidebar Navigation -->
        <aside class="w-full md:w-72 p-8 md:p-12 bg-gradient-to-br from-modernBgLight to-backgroundWhite flex flex-col gap-10 shadow-md md:shadow-lg sticky top-0 h-auto md:h-screen overflow-y-auto border-b md:border-b-0 md:border-r border-modernBorder">
            <div class="flex flex-row md:flex-col gap-5 overflow-x-auto md:overflow-x-hidden pb-2 md:pb-0">
                <button class="step-btn flex-shrink-0 md:flex-shrink text-modernSecondary text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0 transition-colors duration-300 hover:text-modernAccent" data-step="1">
                    <i class="active-icon"></i> <!-- active-icon class added to all i tags -->
                    Basic Info
                </button>
                <button class="step-btn flex-shrink-0 md:flex-shrink text-modernSecondary text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0 transition-colors duration-300 hover:text-modernAccent" data-step="2">
                    <i class="active-icon"></i> <!-- active-icon class added to all i tags -->
                    Business Info
                </button>
                <button class="step-btn flex-shrink-0 md:flex-shrink text-modernSecondary text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0 transition-colors duration-300 hover:text-modernAccent" data-step="3">
                    <i class="active-icon"></i> <!-- active-icon class added to all i tags -->
                    Owner Info
                </button>
                <button class="step-btn flex-shrink-0 md:flex-shrink text-modernSecondary text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0 transition-colors duration-300 hover:text-modernAccent" data-step="4">
                    <i class="active-icon"></i> <!-- active-icon class added to all i tags -->
                    Upload Documents & Signature
                </button>
            </div>
            <div class="mt-auto pt-8 border-t border-modernBorder flex flex-col gap-4">
                <h3 class="font-montserrat text-xl text-modernPrimary mb-1">Have any questions?</h3>
                <p class="text-base text-modernSecondary">Get in contact:</p>
                <a href="mailto:Mendel@ontimecap.com" class="text-modernAccent no-underline font-medium hover:text-modernPrimary transition-colors duration-200">Mendel@ontimecap.com</a>
            </div>
        </aside>

        <!-- Main Form Area - Now wider and without a white box container -->
        <main class="flex-grow flex flex-col items-center justify-start py-8 md:py-12 w-full">
            <form id="applicationForm" class="w-full max-w-5xl px-4 md:px-8"> <!-- Increased max-width for wider pages -->

                <!-- Step 1: Basic Information -->
                <div id="step1" class="form-section active mb-8"> <!-- Removed bg, padding, rounded, shadow classes -->
                    <h2 class="font-montserrat text-modernPrimary text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-modernBorder w-full">Basic Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="fundingAmount" class="block mb-2 font-semibold text-modernPrimary text-lg">How much funding are you looking for?</label>
                            <input type="number" id="fundingAmount" name="fundingAmount" placeholder="Enter amount" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="creditScore" class="block mb-2 font-semibold text-modernPrimary text-lg">What is your credit score?</label>
                            <input type="number" id="creditScore" name="creditScore" min="300" max="850" placeholder="e.g., 700" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="industry" class="block mb-2 font-semibold text-modernPrimary text-lg">What industry are you in?</label>
                            <input type="text" id="industry" name="industry" placeholder="e.g., Retail, Tech, Food Service" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="timeframe" class="block mb-2 font-semibold text-modernPrimary text-lg">What timeframe do you need the money?</label>
                            <select id="timeframe" name="timeframe" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                                <option value="">Select an option</option>
                                <option value="ASAP">ASAP</option>
                                <option value="within_week">Within a week</option>
                                <option value="within_two_weeks">Within two weeks</option>
                                <option value="within_month">Within a month</option>
                                <option value="Browse_rates">Just Browse rates</option>
                            </select>
                        </div>
                        <div class="form-group"> <!-- Removed md:col-span-2 -->
                            <label for="email" class="block mb-2 font-semibold text-modernPrimary text-lg">Email</label>
                            <input type="email" id="email" name="email" placeholder="you@example.com" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group"> <!-- Removed md:col-span-2 -->
                            <label for="phoneNumber" class="block mb-2 font-semibold text-modernPrimary text-lg">Phone Number</label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="(123) 456-7890" maxlength="10" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                    </div>
                    <div class="flex justify-center mt-10">
                        <button type="button" class="continue-btn bg-modernAccent text-white px-8 py-4 rounded-xl text-xl font-semibold shadow-lg hover:bg-darkBlue hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                            Continue
                        </button>
                    </div>
                </div>

                <!-- Step 2: Business Information -->
                <div id="step2" class="form-section hidden mb-8"> <!-- Removed bg, padding, rounded, shadow classes -->
                    <h2 class="font-montserrat text-modernPrimary text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-modernBorder w-full">Business Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="businessLegalName" class="block mb-2 font-semibold text-modernPrimary text-lg">Business Legal Name</label>
                            <input type="text" id="businessLegalName" name="businessLegalName" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="businessDBAName" class="block mb-2 font-semibold text-modernPrimary text-lg">Business DBA Name (if applicable)</label>
                            <input type="text" id="businessDBAName" name="businessDBAName"
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="ein" class="block mb-2 font-semibold text-modernPrimary text-lg">EIN (Employer Identification Number)</label>
                            <input type="text" id="ein" name="ein" placeholder="XX-XXXXXXX" maxlength="9" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="businessStartDate" class="block mb-2 font-semibold text-modernPrimary text-lg">Business Start Date</label>
                            <input type="date" id="businessStartDate" name="businessStartDate" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label class="block mb-2 font-semibold text-modernPrimary text-lg">Legal Entity</label>
                            <div class="flex flex-wrap gap-x-8 gap-y-2">
                                <label class="inline-flex items-center text-modernSecondary text-base cursor-pointer">
                                    <input type="radio" name="legalEntity" value="corporation" required class="form-radio h-5 w-5 text-modernAccent accent-modernAccent mr-2 transform scale-110">
                                    Corporation
                                </label>
                                <label class="inline-flex items-center text-modernSecondary text-base cursor-pointer">
                                    <input type="radio" name="legalEntity" value="llc" class="form-radio h-5 w-5 text-modernAccent accent-modernAccent mr-2 transform scale-110">
                                    LLC
                                </label>
                                <label class="inline-flex items-center text-modernSecondary text-base cursor-pointer">
                                    <input type="radio" name="legalEntity" value="partnership" class="form-radio h-5 w-5 text-modernAccent accent-modernAccent mr-2 transform scale-110">
                                    Partnership
                                </label>
                                <label class="inline-flex items-center text-modernSecondary text-base cursor-pointer">
                                    <input type="radio" name="legalEntity" value="sole_proprietorship" class="form-radio h-5 w-5 text-modernAccent accent-modernAccent mr-2 transform scale-110">
                                    Sole Proprietorship
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="ownershipPercentage" class="block mb-2 font-semibold text-modernPrimary text-lg">Ownership Percentage</label>
                            <input type="number" id="ownershipPercentage" name="ownershipPercentage" min="0" max="100" placeholder="e.g., 100" maxlength="3" oninput="if(this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group"> <!-- Removed md:col-span-2 -->
                            <label for="businessStreetAddress" class="block mb-2 font-semibold text-modernPrimary text-lg">Business Street Address</label>
                            <input type="text" id="businessStreetAddress" name="businessStreetAddress" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="businessCity" class="block mb-2 font-semibold text-modernPrimary text-lg">Business City</label>
                            <input type="text" id="businessCity" name="businessCity" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="businessState" class="block mb-2 font-semibold text-modernPrimary text-lg">Business State</label>
                            <select id="businessState" name="businessState" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                                <option value="">Select a State</option>
                                <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option><option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option><option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option><option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option><option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option><option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option><option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option><option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option><option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option><option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option><option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option><option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option><option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option><option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option><option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option><option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="businessZipCode" class="block mb-2 font-semibold text-modernPrimary text-lg">Business Zip Code</label>
                            <input type="text" id="businessZipCode" name="businessZipCode" maxlength="5" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                    </div>
                    <div class="flex justify-center mt-10">
                        <button type="button" class="continue-btn bg-modernAccent text-white px-8 py-4 rounded-xl text-xl font-semibold shadow-lg hover:bg-darkBlue hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                            Continue
                        </button>
                    </div>
                </div>

                <!-- Step 3: Owner Information -->
                <div id="step3" class="form-section hidden mb-8"> <!-- Removed bg, padding, rounded, shadow classes -->
                    <h2 class="font-montserrat text-modernPrimary text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-modernBorder w-full">Owner Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="ownerFirstName" class="block mb-2 font-semibold text-modernPrimary text-lg">First Name</label>
                            <input type="text" id="ownerFirstName" name="ownerFirstName" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="ownerLastName" class="block mb-2 font-semibold text-modernPrimary text-lg">Last Name</label>
                            <input type="text" id="ownerLastName" name="ownerLastName" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="socialSecurityNumber" class="block mb-2 font-semibold text-modernPrimary text-lg">Social Security Number (SSN)</label>
                            <input type="text" id="socialSecurityNumber" name="socialSecurityNumber" placeholder="XXX-XX-XXXX" maxlength="9" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="dateOfBirth" class="block mb-2 font-semibold text-modernPrimary text-lg">Date of Birth</label>
                            <input type="date" id="dateOfBirth" name="dateOfBirth" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group"> <!-- Removed md:col-span-2 -->
                            <label for="homeStreetAddress" class="block mb-2 font-semibold text-modernPrimary text-lg">Home Street Address</label>
                            <input type="text" id="homeStreetAddress" name="homeStreetAddress" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="homeCity" class="block mb-2 font-semibold text-modernPrimary text-lg">Home City</label>
                            <input type="text" id="homeCity" name="homeCity" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="homeState" class="block mb-2 font-semibold text-modernPrimary text-lg">Home State</label>
                            <select id="homeState" name="homeState" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                                <option value="">Select a State</option>
                                <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option><option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option><option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option><option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option><option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option><option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option><option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option><option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option><option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option><option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option><option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option><option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option><option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option><option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option><option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option><option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="homeZipCode" class="block mb-2 font-semibold text-modernPrimary text-lg">Home Zip Code</label>
                            <input type="text" id="homeZipCode" name="homeZipCode" maxlength="5" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                    </div>
                    <div class="flex justify-center mt-10">
                        <button type="button" class="continue-btn bg-modernAccent text-white px-8 py-4 rounded-xl text-xl font-semibold shadow-lg hover:bg-darkBlue hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                            Continue
                        </button>
                    </div>
                </div>

                <!-- Step 4: Upload Documents & Signature -->
                <div id="step4" class="form-section hidden mb-8"> <!-- Removed bg, padding, rounded, shadow classes -->
                    <h2 class="font-montserrat text-modernPrimary text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-modernBorder w-full">Upload Documents & Signature</h2>
                    <div class="form-group mb-6 w-full">
                        <label class="block mb-2 font-semibold text-modernPrimary text-lg">Upload Business Bank Statements (Last 3 months)</label>
                        <div class="file-upload-box flex flex-col items-center justify-center p-8 border-2 border-dashed border-modernBorder rounded-xl bg-inputBg cursor-pointer hover:border-modernAccent hover:bg-lightBlueBg transition-all duration-300"
                            onclick="document.getElementById('bankStatements').click()">
                            <i class="fas fa-cloud-upload-alt text-modernAccent text-5xl mb-4"></i>
                            <p class="text-modernSecondary font-medium text-lg text-center">Drag & Drop files here or click to browse</p>
                            <input type="file" id="bankStatements" name="bankStatements" accept=".pdf, .doc, .docx, .png, .jpg" multiple class="hidden">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="ownerNameSignature" class="block mb-2 font-semibold text-modernPrimary text-lg">Owner Name (for signature)</label>
                            <input type="text" id="ownerNameSignature" name="ownerNameSignature" placeholder="Full Legal Name" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                        <div class="form-group">
                            <label for="signatureDate" class="block mb-2 font-semibold text-modernPrimary text-lg">Date</label>
                            <input type="date" id="signatureDate" name="signatureDate" required
                                class="w-full p-3 border border-modernBorder rounded-lg text-lg shadow-sm focus:border-modernAccent focus:ring-2 focus:ring-modernAccent/30 transition-all duration-200 bg-inputBg text-modernSecondary">
                        </div>
                    </div>
                    <div class="form-group mb-6 w-full">
                        <label for="signatureCanvas" class="block mb-2 font-semibold text-modernPrimary text-lg">Signature</label>
                        <div class="signature-canvas-container relative border border-modernBorder rounded-lg bg-inputBg cursor-crosshair shadow-sm h-40 w-full">
                            <canvas id="signatureCanvas" class="block w-full h-full rounded-lg"></canvas>
                            <button type="button" id="clearSignature" class="absolute bottom-3 right-3 bg-modernBgLight border border-modernBorder rounded-md px-3 py-1.5 text-sm cursor-pointer z-10 hover:bg-gray-200 transition-colors duration-200 text-modernSecondary">
                                Clear
                            </button>
                        </div>
                        <input type="hidden" id="signatureData" name="signatureData">
                    </div>
                    <div class="flex justify-center mt-10 w-full">
                        <button type="submit" class="bg-accentGreen text-white px-8 py-4 rounded-xl text-xl font-semibold shadow-lg hover:bg-green-700 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                            Submit Application
                        </button>
                    </div>
                </div>
            </form>
        </main>
    </div>

    <!-- Footer Section -->
    <footer class="bg-backgroundWhite p-5 md:px-10 flex flex-col md:flex-row justify-between items-center border-t border-modernBorder text-modernSecondary text-sm font-normal">
        <div class="flex flex-col md:flex-row items-center gap-4 md:gap-8 mb-4 md:mb-0">
            <span class="font-semibold text-modernPrimary text-lg">Customer Reviews:</span>
            <div class="flex items-center gap-4">
                <a href="https://www.trustpilot.com/review/ontimecap.com" target="_blank">
                    <img src="https://placehold.co/120x40/e0f7fa/007bff?text=Trustpilot" alt="Trustpilot Reviews" class="h-12 w-auto opacity-95 hover:opacity-100 hover:-translate-y-0.5 transition-all duration-200">
                </a>
                <a href="https://www.bbb.org/us/ny/brooklyn/profile/loan-broker/on-time-capital-llc-0121-87177095" target="_blank">
                    <img src="https://placehold.co/120x40/e0f7fa/007bff?text=BBB" alt="BBB Reviews" class="h-12 w-auto opacity-95 hover:opacity-100 hover:-translate-y-0.5 transition-all duration-200">
                </a>
                <a href="https://www.google.com/search?q=on+time+capital+reviews" target="_blank">
                    <img src="https://placehold.co/120x40/e0f7fa/007bff?text=Google" alt="Google Reviews" class="h-12 w-auto opacity-95 hover:opacity-100 hover:-translate-y-0.5 transition-all duration-200">
                </a>
            </div>
        </div>
        <div class="text-modernSecondary">
            Copyright &copy; 2025 On Time Capital, LLC.
        </div>
    </footer>

    <script>
        // Get all form sections and navigation buttons
        const formSections = document.querySelectorAll('.form-section');
        const stepButtons = document.querySelectorAll('.step-btn');
        const continueButtons = document.querySelectorAll('.continue-btn');
        let currentStep = 0; // Initialize current step to the first one (0-indexed)

        // Signature Pad Elements
        const signatureCanvas = document.getElementById('signatureCanvas');
        const ctx = signatureCanvas.getContext('2d');
        const clearSignatureBtn = document.getElementById('clearSignature');
        const signatureDataInput = document.getElementById('signatureData');
        let drawing = false; // Flag to track if drawing is in progress

        /**
         * Resizes the signature canvas to fit its parent container.
         * Redraws existing signature data if available.
         */
        function resizeCanvas() {
            const container = signatureCanvas.parentElement;
            // Set canvas's display size to fill the container
            signatureCanvas.style.width = '100%';
            signatureCanvas.style.height = '100%';
            // Set canvas's internal drawing surface size to match actual pixels
            signatureCanvas.width = container.clientWidth;
            signatureCanvas.height = container.clientHeight;

            // Configure drawing properties
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#000';

            // If there's existing signature data, redraw it after resize to prevent loss
            if (signatureDataInput.value) {
                const img = new Image();
                img.onload = () => {
                    ctx.drawImage(img, 0, 0, signatureCanvas.width, signatureCanvas.height);
                };
                img.src = signatureDataInput.value;
            }
        }

        // Event listener for window resize to make canvas responsive
        window.addEventListener('resize', resizeCanvas);
        // Initial call to set canvas size when the page loads
        resizeCanvas();

        // Mouse event listeners for signature drawing
        signatureCanvas.addEventListener('mousedown', (e) => {
            drawing = true;
            ctx.beginPath(); // Start a new path
            const rect = signatureCanvas.getBoundingClientRect(); // Get canvas position
            // Move to the current mouse position relative to the canvas
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        });

        signatureCanvas.addEventListener('mousemove', (e) => {
            if (!drawing) return; // Only draw if mouse is down
            const rect = signatureCanvas.getBoundingClientRect();
            // Draw a line to the current mouse position relative to the canvas
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke(); // Render the line
        });

        signatureCanvas.addEventListener('mouseup', () => {
            drawing = false; // Stop drawing when mouse is released
            // Save the signature as a data URL in the hidden input field
            signatureDataInput.value = signatureCanvas.toDataURL();
        });

        signatureCanvas.addEventListener('mouseout', () => {
            // Stop drawing if mouse leaves the canvas area
            drawing = false;
        });

        // Clear signature button functionality
        clearSignatureBtn.addEventListener('click', () => {
            ctx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height); // Clear the canvas
            signatureDataInput.value = ''; // Clear the hidden input value
        });

        // Touch event listeners for mobile signature drawing
        signatureCanvas.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Prevent default touch behavior (like scrolling)
            drawing = true;
            const touch = e.touches[0]; // Get the first touch point
            const rect = signatureCanvas.getBoundingClientRect();
            ctx.beginPath();
            ctx.moveTo(touch.clientX - rect.left, touch.clientY - rect.top);
        });

        signatureCanvas.addEventListener('touchmove', (e) => {
            e.preventDefault(); // Prevent default touch behavior
            if (!drawing) return;
            const touch = e.touches[0];
            const rect = signatureCanvas.getBoundingClientRect();
            ctx.lineTo(touch.clientX - rect.left, touch.clientY - rect.top);
            ctx.stroke();
        });

        signatureCanvas.addEventListener('touchend', () => {
            drawing = false;
            signatureDataInput.value = signatureCanvas.toDataURL();
        });

        /**
         * Shows a specific step in the multi-step form and updates sidebar navigation.
         * @param {number} stepIndex - The 0-indexed number of the step to show.
         */
        function showStep(stepIndex) {
            // Hide all form sections and remove 'active' class from sidebar buttons
            formSections.forEach((section, index) => {
                section.classList.add('hidden');
                section.classList.remove('active');
            });
            stepButtons.forEach((button) => {
                button.classList.remove('active-step');
                // The icon change is now handled purely by CSS based on .active-step
            });

            // Show the target step and update its corresponding sidebar button
            formSections[stepIndex].classList.remove('hidden');
            formSections[stepIndex].classList.add('active');
            stepButtons[stepIndex].classList.add('active-step');

            currentStep = stepIndex; // Update the current step index

            // Scroll the main form content area to the top when changing steps
            const mainContentArea = document.querySelector('main'); // Target the main tag
            if (mainContentArea) {
                mainContentArea.scrollTop = 0;
            }
        }

        // Initialize form to show the first step when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            showStep(0);
        });

        /**
         * Validates all required fields within a given form step.
         * Applies red border to invalid fields.
         * @param {HTMLElement} stepElement - The DOM element of the current form step.
         * @returns {boolean} True if all required fields are valid, false otherwise.
         */
        function validateCurrentStep(stepElement) {
            const inputs = stepElement.querySelectorAll('[required]');
            let allValid = true;

            inputs.forEach(input => {
                let isValid = true;

                // Handle text, email, number, date, select, textarea, file inputs
                if (input.type !== 'radio' && input.type !== 'file' && input.value.trim() === '') {
                    isValid = false;
                }
                // Handle file inputs (check if files are selected, if required)
                if (input.type === 'file' && input.hasAttribute('required') && input.files.length === 0) {
                    isValid = false;
                }

                // Handle radio groups: check if at least one radio in the group is checked
                if (input.type === 'radio') {
                    const radioGroupName = input.name;
                    if (stepElement.querySelector(`input[name="${radioGroupName}"]:checked`) === null) {
                        isValid = false;
                    }
                }

                // Apply/remove error styling based on validity
                if (!isValid) {
                    allValid = false;
                    input.classList.add('border-red-500'); // Tailwind class for red border
                    input.classList.remove('border-modernBorder');
                } else {
                    input.classList.remove('border-red-500');
                    input.classList.add('border-modernBorder');
                }
            });

            // Specific validation for signature (Step 4)
            if (stepElement.id === 'step4') {
                const signatureInput = document.getElementById('signatureData');
                const ownerNameInput = document.getElementById('ownerNameSignature');
                const signatureDateInput = document.getElementById('signatureDate');
                const signatureCanvasContainer = document.querySelector('.signature-canvas-container');

                // Validate Owner Name
                if (ownerNameInput.value.trim() === '') {
                    ownerNameInput.classList.add('border-red-500');
                    ownerNameInput.classList.remove('border-modernBorder');
                    allValid = false;
                } else {
                    ownerNameInput.classList.remove('border-red-500');
                    ownerNameInput.classList.add('border-modernBorder');
                }

                // Validate Signature Date
                if (signatureDateInput.value.trim() === '') {
                    signatureDateInput.classList.add('border-red-500');
                    signatureDateInput.classList.remove('border-modernBorder');
                    allValid = false;
                } else {
                    signatureDateInput.classList.remove('border-red-500');
                    signatureDateInput.classList.add('border-modernBorder');
                }

                // Validate Signature Canvas
                if (signatureInput.value === '') {
                    signatureCanvasContainer.classList.add('border-red-500'); // Apply red border to container
                    signatureCanvasContainer.classList.remove('border-modernBorder');
                    allValid = false;
                } else {
                    signatureCanvasContainer.classList.remove('border-red-500');
                    signatureCanvasContainer.classList.add('border-modernBorder');
                }
            }

            return allValid;
        }

        // Event listeners for 'Continue' buttons
        continueButtons.forEach(button => {
            button.addEventListener('click', () => {
                const currentFormSection = formSections[currentStep];
                if (validateCurrentStep(currentFormSection)) {
                    if (currentStep < formSections.length - 1) {
                        showStep(currentStep + 1);
                    }
                } else {
                    showMessageBox('Please fill out all required fields correctly before proceeding.', 'error');
                }
            });
        });

        // Event listeners for sidebar step buttons (allow jumping backwards or forwards with validation)
        stepButtons.forEach((button, index) => {
            button.addEventListener('click', () => {
                if (index < currentStep) { // Navigating backwards: no validation needed
                    showStep(index);
                } else if (index > currentStep) { // Navigating forwards: validate current step
                    const currentFormSection = formSections[currentStep];
                    if (validateCurrentStep(currentFormSection)) {
                        showStep(index);
                    } else {
                        showMessageBox('Please fill out all required fields correctly before proceeding.', 'error');
                    }
                }
                // If index == currentStep, do nothing
            });
        });

        // Main form submission handler
        document.getElementById('applicationForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default browser form submission
            // Validate the current (last) step before final submission
            if (validateCurrentStep(formSections[currentStep])) {
                showMessageBox('Application Submitted! Thank you for your submission.', 'success');
                // In a real application, you would collect form data and send it to a server here.
                const formData = new FormData(this);
                const data = {};
                for (let [key, value] of formData.entries()) {
                    data[key] = value;
                }
                data.signatureData = signatureDataInput.value; // Add signature data
                console.log('Form Data:', data); // Log collected data for demonstration
            } else {
                showMessageBox('Please fill out all required fields correctly before submitting.', 'error');
            }
        });

        // Reset border color on input/select/textarea change or input
        document.querySelectorAll('input, select, textarea').forEach(input => {
            input.addEventListener('input', function() {
                this.classList.remove('border-red-500');
                this.classList.add('border-modernBorder');
                // Special handling for signature canvas border reset
                if (this.id === 'signatureData' || this.id === 'ownerNameSignature' || this.id === 'signatureDate') {
                    document.querySelector('.signature-canvas-container').classList.remove('border-red-500');
                    document.querySelector('.signature-canvas-container').classList.add('border-modernBorder');
                }
            });
            input.addEventListener('change', function() { // For selects, radios, dates, files
                this.classList.remove('border-red-500');
                this.classList.add('border-modernBorder');
            });
        });

        /**
         * Displays a custom message box at the top of the screen.
         * @param {string} message - The message to display.
         * @param {string} type - The type of message ('success', 'error', 'info').
         */
        function showMessageBox(message, type = 'info') {
            let messageBox = document.getElementById('customMessageBox');
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = 'customMessageBox';
                document.body.appendChild(messageBox);
            }

            messageBox.innerHTML = ''; // Clear previous content
            let iconHtml = '';
            let bgColor = '';
            let textColor = '#ffffff';

            // Determine icon and colors based on message type
            if (type === 'success') {
                iconHtml = '<i class="fas fa-check-circle"></i>';
                bgColor = tailwind.config.theme.extend.colors.accentGreen;
            } else if (type === 'error') {
                iconHtml = '<i class="fas fa-times-circle"></i>';
                bgColor = '#dc3545'; /* Specific red for error */
            } else { // info
                iconHtml = '<i class="fas fa-info-circle"></i>';
                bgColor = tailwind.config.theme.extend.colors.primaryBlue;
            }

            messageBox.style.backgroundColor = bgColor;
            messageBox.style.color = textColor;
            messageBox.innerHTML = `${iconHtml}<span>${message}</span>`;

            // Show the message box with animation
            messageBox.style.opacity = '1';
            messageBox.style.transform = 'translateX(-50%) translateY(0)';

            // Hide after 3 seconds with animation
            setTimeout(() => {
                messageBox.style.opacity = '0';
                messageBox.style.transform = 'translateX(-50%) translateY(-20px)';
                // Remove from DOM after transition completes
                setTimeout(() => {
                    if (messageBox.parentNode) {
                        messageBox.parentNode.removeChild(messageBox);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
