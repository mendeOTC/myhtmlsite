<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Funding Application - Redesigned</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* All your CSS styles remain the same */
        body {
            font-family: 'Open Sans', sans-serif;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <header class="header-bg p-4 md:px-10 flex flex-col md:flex-row justify-between items-center sticky top-0 z-50">
        <a href="https://ontimecap.com/" class="logo-link mb-4 md:mb-0 md:absolute md:left-10" target="_blank">
            <img src="https://ontimecap.com/wp-content/uploads/2024/05/logos3-1.png" alt="On Time Capital Logo" class="h-14 transition-transform duration-200 hover:scale-105">
        </a>
        <div class="flex items-center gap-2 md:relative md:right-10 whitespace-nowrap" style="letter-spacing: -0.05em; margin-left: auto;">
            <span class="text-lg font-montserrat font-semibold text-theme-heading">Need help?</span>
            <i class="fas fa-phone-alt text-xl text-theme-primary"></i>
            <a href="tel:4122046096" class="text-xl text-theme-heading no-underline hover:text-theme-primary transition-colors duration-200 font-montserrat font-extralight">412 204 6096</a>
        </div>
    </header>

    <div class="flex flex-col md:flex-row flex-grow w-full">

        <aside id="sidebar" class="sidebar-bg w-full md:w-72 p-8 md:p-12 flex flex-col gap-10 sticky top-0 h-auto md:h-screen overflow-y-auto">
             <div class="flex flex-row md:flex-col gap-5 overflow-x-auto md:overflow-x-hidden pb-2 md:pb-0">
                <button class="step-btn flex-shrink-0 md:flex-shrink text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0" data-step="1">Basic Info</button>
                <button class="step-btn flex-shrink-0 md:flex-shrink text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0" data-step="2">Business Info</button>
                <button class="step-btn flex-shrink-0 md:flex-shrink text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0" data-step="3">Owner Info</button>
                <button class="step-btn flex-shrink-0 md:flex-shrink text-left text-lg font-montserrat font-medium py-3 px-0 md:px-0 relative pl-8 md:pl-0" data-step="4">Upload & Signature</button>
            </div>
        </aside>

        <main id="mainContent" class="flex-grow flex flex-col items-center justify-start py-8 md:py-12 w-full">
            
            <form id="applicationForm" class="w-full max-w-5xl px-4 md:px-8" method="post" action="https://form.jotform.com/252018689230154" enctype="multipart/form-data">

                <div id="step1" class="form-section active">
                    <h2 class="font-montserrat text-theme-heading text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-theme-border w-full">Basic Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="fundingAmount" class="block mb-2 font-semibold text-theme-heading text-lg">How much funding are you looking for?</label>
                            <input type="number" id="fundingAmount" name="howMuch" placeholder="Enter amount" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="creditScore" class="block mb-2 font-semibold text-theme-heading text-lg">What is your credit score?</label>
                            <input type="number" id="creditScore" name="creditScore" min="300" max="850" placeholder="e.g., 700" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="industry" class="block mb-2 font-semibold text-theme-heading text-lg">What industry are you in?</label>
                            <input type="text" id="industry" name="typeA95" placeholder="e.g., Retail, Tech, Food Service" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="timeframe" class="block mb-2 font-semibold text-theme-heading text-lg">What timeframe do you need the money?</label>
                            <select id="timeframe" name="typeA90" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                                <option value="">Select an option</option>
                                <option value="ASAP">ASAP</option>
                                <option value="within_week">Within a week</option>
                                <option value="within_two_weeks">Within two weeks</option>
                                <option value="within_month">Within a month</option>
                                <option value="Browse_rates">Just Browse rates</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="email" class="block mb-2 font-semibold text-theme-heading text-lg">Email</label>
                            <input type="email" id="email" name="email" placeholder="you@example.com" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber" class="block mb-2 font-semibold text-theme-heading text-lg">Phone Number</label>
                            <input type="tel" id="phoneNumber" name="phone" placeholder="(123) 456-7890" maxlength="10" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                    </div>
                    <div class="flex justify-center mt-10">
                        <button type="button" class="continue-btn px-8 py-4 rounded-xl text-xl font-semibold shadow-lg button-style">Continue</button>
                    </div>
                </div>

                <div id="step2" class="form-section hidden">
                    <h2 class="font-montserrat text-theme-heading text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-theme-border w-full">Business Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="businessLegalName" class="block mb-2 font-semibold text-theme-heading text-lg">Business Legal Name</label>
                            <input type="text" id="businessLegalName" name="businessLegal" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="businessDBAName" class="block mb-2 font-semibold text-theme-heading text-lg">Business DBA Name</label>
                            <input type="text" id="businessDBAName" name="businessDba" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="ein" class="block mb-2 font-semibold text-theme-heading text-lg">EIN (Employer Identification Number)</label>
                            <input type="text" id="ein" name="ein" placeholder="XX-XXXXXXX" maxlength="9" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="businessStartDate" class="block mb-2 font-semibold text-theme-heading text-lg">Business Start Date</label>
                            <input type="date" id="businessStartDate" name="businessStart" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label class="block mb-2 font-semibold text-theme-heading text-lg">Legal Entity</label>
                            <div class="flex flex-wrap gap-x-8 gap-y-2" id="legalEntityRadios">
                                <label class="inline-flex items-center text-theme-text text-base cursor-pointer"><input type="radio" name="legalEntity" value="corporation" class="form-radio h-5 w-5 mr-2"> Corporation</label>
                                <label class="inline-flex items-center text-theme-text text-base cursor-pointer"><input type="radio" name="legalEntity" value="llc" class="form-radio h-5 w-5 mr-2"> LLC</label>
                                <label class="inline-flex items-center text-theme-text text-base cursor-pointer"><input type="radio" name="legalEntity" value="partnership" class="form-radio h-5 w-5 mr-2"> Partnership</label>
                                <label class="inline-flex items-center text-theme-text text-base cursor-pointer"><input type="radio" name="legalEntity" value="sole_proprietorship" class="form-radio h-5 w-5 mr-2"> Sole Proprietorship</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="ownershipPercentage" class="block mb-2 font-semibold text-theme-heading text-lg">Ownership Percentage</label>
                            <input type="number" id="ownershipPercentage" name="ownershipPercentage112" min="0" max="100" placeholder="e.g., 100" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="businessStreetAddress" class="block mb-2 font-semibold text-theme-heading text-lg">Business Street Address</label>
                            <input type="text" id="businessStreetAddress" name="businessStreet" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="businessCity" class="block mb-2 font-semibold text-theme-heading text-lg">Business City</label>
                            <input type="text" id="businessCity" name="businessCity" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="businessState" class="block mb-2 font-semibold text-theme-heading text-lg">Business State</label>
                            <select id="businessState" name="business_state" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                                <option value="">Select a State</option>
                                <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option><option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option><option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option><option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option><option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option><option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option><option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option><option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option><option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option><option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option><option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option><option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option><option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option><option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option><option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option><option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="businessZipCode" class="block mb-2 font-semibold text-theme-heading text-lg">Business Zip Code</label>
                            <input type="text" id="businessZipCode" name="businessZip" maxlength="5" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                    </div>
                    <div class="flex justify-center mt-10">
                        <button type="button" class="continue-btn px-8 py-4 rounded-xl text-xl font-semibold shadow-lg button-style">Continue</button>
                    </div>
                </div>

                <div id="step3" class="form-section hidden">
                    <h2 class="font-montserrat text-theme-heading text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-theme-border w-full">Owner Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="ownerFirstName" class="block mb-2 font-semibold text-theme-heading text-lg">First Name</label>
                            <input type="text" id="ownerFirstName" name="firstName" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="ownerLastName" class="block mb-2 font-semibold text-theme-heading text-lg">Last Name</label>
                            <input type="text" id="ownerLastName" name="lastName" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="socialSecurityNumber" class="block mb-2 font-semibold text-theme-heading text-lg">Social Security Number (SSN)</label>
                            <input type="text" id="socialSecurityNumber" name="ssn" placeholder="XXX-XX-XXXX" maxlength="9" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="dateOfBirth" class="block mb-2 font-semibold text-theme-heading text-lg">Date of Birth</label>
                            <input type="date" id="dateOfBirth" name="dateOf" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="homeStreetAddress" class="block mb-2 font-semibold text-theme-heading text-lg">Home Street Address</label>
                            <input type="text" id="homeStreetAddress" name="street20" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="homeCity" class="block mb-2 font-semibold text-theme-heading text-lg">Home City</label>
                            <input type="text" id="homeCity" name="city21" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="homeState" class="block mb-2 font-semibold text-theme-heading text-lg">Home State</label>
                            <select id="homeState" name="owner_state" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                                <option value="">Select a State</option>
                                </select>
                        </div>
                        <div class="form-group">
                            <label for="homeZipCode" class="block mb-2 font-semibold text-theme-heading text-lg">Home Zip Code</label>
                            <input type="text" id="homeZipCode" name="zip23" maxlength="5" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                    </div>
                    <div class="flex justify-center mt-10">
                        <button type="button" class="continue-btn px-8 py-4 rounded-xl text-xl font-semibold shadow-lg button-style">Continue</button>
                    </div>
                </div>

                <div id="step4" class="form-section hidden">
                    <h2 class="font-montserrat text-theme-heading text-3xl md:text-4xl font-bold text-center mb-10 pb-3 border-b-2 border-theme-border w-full">Upload Documents & Signature</h2>
                    <div class="form-group mb-6 w-full">
                        <label class="block mb-2 font-semibold text-theme-heading text-lg">Upload Business Bank Statements (Last 3 months) (Optional)</label>
                        <div class="file-upload-box flex flex-col items-center justify-center p-8 border-2 border-dashed rounded-xl cursor-pointer shadow-sm file-upload-box-style" id="fileUploadArea">
                            <i class="fas fa-cloud-upload-alt text-5xl mb-4 file-icon-style"></i>
                            <p class="text-theme-secondary font-medium text-lg text-center">Drag & Drop files here or click to browse</p>
                            <input type="file" id="bankStatements" name="3Business" multiple class="hidden">
                        </div>
                        <div id="fileList" class="mt-4 space-y-2"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-6">
                        <div class="form-group">
                            <label for="ownerNameSignature" class="block mb-2 font-semibold text-theme-heading text-lg">Owner Name (for signature)</label>
                            <input type="text" id="ownerNameSignature" name="ownerName" placeholder="Full Legal Name" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                        <div class="form-group">
                            <label for="signatureDate" class="block mb-2 font-semibold text-theme-heading text-lg">Date</label>
                            <input type="date" id="signatureDate" name="date" required class="w-full p-3 rounded-lg text-lg shadow-sm input-style">
                        </div>
                    </div>
                    <div class="form-group mb-6 w-full">
                        <label for="signatureCanvas" class="block mb-2 font-semibold text-theme-heading text-lg">Signature</label>
                        <div class="signature-canvas-container relative border rounded-lg cursor-crosshair shadow-sm h-40 w-full">
                            <canvas id="signatureCanvas"></canvas>
                        </div>
                        <input type="hidden" id="signatureData" name="ownersSignature">
                    </div>
                    <div class="flex justify-center mt-10 w-full">
                        <button type="submit" id="submitApplicationBtn" class="px-8 py-4 rounded-xl text-xl font-semibold shadow-lg button-style">Submit Application</button>
                    </div>
                </div>
            </form>
        </main>
    </div>

    <footer>
        </footer>

    <script>
        // --- Multi-Step Form Logic ---
        const formSections = document.querySelectorAll('.form-section');
        const stepButtons = document.querySelectorAll('.step-btn');
        const continueButtons = document.querySelectorAll('.continue-btn');
        let currentStep = 0;

        function showStep(stepIndex) {
            formSections.forEach((section, index) => {
                section.classList.toggle('hidden', index !== stepIndex);
                section.classList.toggle('active', index === stepIndex);
            });
            if(stepButtons.length > 0) {
                stepButtons.forEach((button, index) => {
                    button.classList.toggle('active-step', index === stepIndex);
                });
            }
            currentStep = stepIndex;
            window.scrollTo(0, 0);
        }

        function validateCurrentStep() {
            const currentSection = formSections[currentStep];
            const requiredFields = currentSection.querySelectorAll('[required]');
            let isValid = true;
            for (const field of requiredFields) {
                if (field.type === 'hidden' || !field.value.trim()) {
                     if (field.id === 'signatureData' && field.value.trim() !== '') {
                        continue; // If signature has data, it's valid
                    }
                    isValid = false;
                    field.classList.add('border-red-500');
                } else {
                    field.classList.remove('border-red-500');
                }
            }
            return isValid;
        }
        
        continueButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (validateCurrentStep()) {
                    if (currentStep < formSections.length - 1) {
                        showStep(currentStep + 1);
                    }
                } else {
                    alert('Please fill in all required fields.');
                }
            });
        });
        
        // --- Signature Pad Logic ---
        const signatureCanvas = document.getElementById('signatureCanvas');
        if (signatureCanvas) {
            const ctx = signatureCanvas.getContext('2d');
            const signatureDataInput = document.getElementById('signatureData');
            let isDrawing = false;
            
            function resizeCanvas() {
                signatureCanvas.width = signatureCanvas.offsetWidth;
                signatureCanvas.height = signatureCanvas.offsetHeight;
            }
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();

            const getEventPos = (e) => {
                const rect = signatureCanvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                return { x: clientX - rect.left, y: clientY - rect.top };
            };

            const startDrawing = (e) => { isDrawing = true; const pos = getEventPos(e); ctx.beginPath(); ctx.moveTo(pos.x, pos.y); };
            const draw = (e) => { if (!isDrawing) return; e.preventDefault(); const pos = getEventPos(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); };
            const stopDrawing = () => { if (!isDrawing) return; isDrawing = false; signatureDataInput.value = signatureCanvas.toDataURL(); };

            signatureCanvas.addEventListener('mousedown', startDrawing);
            signatureCanvas.addEventListener('mousemove', draw);
            signatureCanvas.addEventListener('mouseup', stopDrawing);
            signatureCanvas.addEventListener('mouseout', stopDrawing);
            signatureCanvas.addEventListener('touchstart', startDrawing);
            signatureCanvas.addEventListener('touchmove', draw);
            signatureCanvas.addEventListener('touchend', stopDrawing);
        }
        
        // --- Form Submission Logic (Corrected for Jotform) ---
        const applicationForm = document.getElementById('applicationForm');
        applicationForm.addEventListener('submit', function(event) {
            // Save signature data one last time before submitting
            if (signatureCanvas && document.getElementById('signatureData').value) {
                document.getElementById('signatureData').value = signatureCanvas.toDataURL();
            }

            if (!validateCurrentStep()) {
                event.preventDefault(); // Stop submission if the final step is invalid
                alert('Please fill in all required fields before submitting.');
            }
        });

        showStep(0);
    </script>
</body>
</html>
